# 🚀 社交登录快速配置指南

## 第三步：配置 GitHub 登录

### 1. 打开 GitHub 设置
在浏览器打开：https://github.com/settings/developers

### 2. 创建 OAuth 应用
- 点击右上角的 **"New OAuth App"** 绿色按钮
- 填写以下信息：

| 字段 | 填写内容 |
|------|---------|
| Application name | `双铭策划博客` |
| Homepage URL | `http://localhost:3000` |
| Authorization callback URL | `http://localhost:3000/api/auth/callback/github` |

- 点击 **"Register application"**

### 3. 获取凭证
- 复制 **Client ID**（一串字母数字）
- 点击 **"Generate a new client secret"**
- 复制生成的 **Client Secret**（只显示一次，一定要复制！）

### 4. 填写到 .env 文件
打开项目根目录的 `.env` 文件，找到这两行：
```env
GITHUB_CLIENT_ID=""
GITHUB_CLIENT_SECRET=""
```

把刚才复制的内容填进去（放在双引号中间）：
```env
GITHUB_CLIENT_ID="你的Client ID"
GITHUB_CLIENT_SECRET="你的Client Secret"
```

---

## 第四步：配置 Google 登录

### 1. 创建 Google Cloud 项目
在浏览器打开：https://console.cloud.google.com/

- 点击顶部的项目下拉菜单
- 点击 **"NEW PROJECT"**
- 项目名称填：`双铭策划博客`
- 点击 **"CREATE"**

### 2. 启用 Google+ API
- 左侧菜单 → **APIs & Services** → **Library**
- 搜索框输入：`Google+ API`
- 点击进入，点击 **"ENABLE"**

### 3. 配置 OAuth 同意屏幕
- 左侧菜单 → **OAuth consent screen**
- 选择 **"External"**（外部用户）
- 点击 **"CREATE"**
- 填写以下信息：

| 字段 | 填写内容 |
|------|---------|
| App name | `双铭策划博客` |
| User support email | 选择你的邮箱 |
| Developer contact information | 填写你的邮箱 |

- 其他留空，点击 **"SAVE AND CONTINUE"**
- 后续页面直接点 **"SAVE AND CONTINUE"** 到底

### 4. 创建 OAuth 凭证
- 左侧菜单 → **Credentials**
- 点击顶部 **"+ CREATE CREDENTIALS"**
- 选择 **"OAuth client ID"**
- Application type 选择 **"Web application"**
- Name 填：`双铭策划博客`

在 **Authorized redirect URIs** 部分：
- 点击 **"+ ADD URI"**
- 填写：`http://localhost:3000/api/auth/callback/google`
- 点击 **"CREATE"**

### 5. 获取凭证
弹窗会显示：
- **Client ID**（一串长字符串）
- **Client Secret**（一串短字符串）

复制这两个值！

### 6. 填写到 .env 文件
打开项目根目录的 `.env` 文件，找到这两行：
```env
GOOGLE_CLIENT_ID=""
GOOGLE_CLIENT_SECRET=""
```

把刚才复制的内容填进去：
```env
GOOGLE_CLIENT_ID="你的Client ID"
GOOGLE_CLIENT_SECRET="你的Client Secret"
```

---

## 第五步：启动测试

### 1. 重启开发服务器
在终端按 `Ctrl + C` 停止服务器，然后重新启动：
```bash
npm run dev
```

### 2. 测试登录
1. 在浏览器打开：http://localhost:3000
2. 点击右上角的 **"登录"** 按钮
3. 选择 **GitHub** 或 **Google** 登录
4. 授权后应该能看到你的头像

### 3. 测试发布功能
1. 登录后，点击 **"成功案例"** 页面的 **"发布案例"** 按钮
2. 填写标题、内容
3. 可以上传图片和视频
4. 点击发布

---

## ⚠️ 常见问题

### 问题1：登录后显示 "redirect_uri_mismatch"
**原因**：回调 URL 填写错误

**解决**：
- 检查 GitHub/Google OAuth 设置中的回调 URL
- 必须完全一致（包括 http/https）：
  - GitHub: `http://localhost:3000/api/auth/callback/github`
  - Google: `http://localhost:3000/api/auth/callback/google`

### 问题2：Google 登录显示 "Access blocked"
**原因**：OAuth 同意屏幕未配置完整

**解决**：
- 进入 Google Cloud Console
- OAuth consent screen → 确保填写了必填项
- 或者在 "Test users" 中添加你的 Google 账号

### 问题3：登录成功但没有保存 session
**原因**：数据库连接问题

**解决**：
- 检查 `.env` 中的 `DATABASE_URL` 是否正确
- 确保已经推送过数据库 schema：`npx prisma db push`

---

## 🎉 完成！

配置完成后，你的网站就支持：
- ✅ GitHub 登录
- ✅ Google 登录
- ✅ 只有登录用户可以发布文章
- ✅ 每页显示 10 篇文章
- ✅ 分页浏览

需要帮助？查看 `docs/OAUTH_SETUP.md` 获取更详细的说明。
